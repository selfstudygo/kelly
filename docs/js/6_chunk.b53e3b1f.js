(this.webpackJsonptheblog=this.webpackJsonptheblog||[]).push([[6],{340:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(0),o=t.n(r),a=t(325),i=t.n(a),s=t(341),c=function(e){var n=e.code,t=e.lang||"javascript",r=i.a.highlight(n,i.a.languages[t],t);return o.a.createElement("pre",null,o.a.createElement("code",{spellCheck:"false",dangerouslySetInnerHTML:{__html:r.replace(/^\n/,"")}}),o.a.createElement(s.a,{text:n}))}},356:function(e,n,t){"use strict";t.r(n),t.d(n,"NoSupport",(function(){return g})),t.d(n,"Article",(function(){return v}));var r=t(23),o=t(2),a=t(0),i=t.n(a),s=t(1),c=t(340);function l(){var e=Object(o.a)(["\n  position: relative;\n  video {\n    width: 60rem;\n    height: 40rem;\n    margin: 0 auto;\n  }\n"]);return l=function(){return e},e}function d(){var e=Object(o.a)(["\n  margin: 2rem auto;\n  padding: 2rem;\n  text-align: center;\n  min-height: 150px;\n  font-weight: 600;\n  font-size: 2.4rem;\n  display: flex;\n  color: #fff;\n  align-items: center;\n  justify-content: center;\n  background-size: 100% 100%;\n  text-shadow: 2px 2px 2px rgba(0, 0, 0, 0.3);\n  background: linear-gradient(\n    45deg,\n    #ff0000,\n    #ff7300,\n    #fffb00,\n    #48ff00,\n    #00ffd5,\n    #002bff,\n    #7a00ff,\n    #ff00c8,\n    #ff0000\n  );\n"]);return d=function(){return e},e}var u=s.d.div(d()),f={audio:!1,video:{width:{exact:720},height:{exact:480}}},m=s.d.div(l()),g=function(e){var n=e.text;return(i.a.createElement(u,null,i.a.createElement("div",{style:{maxWidth:"450px"}},i.a.createElement("span",{role:"img","aria-label":"cry",className:"emoji-cry"}),"\xa0",n)))},v=function(e){e.summary;var n=Object(a.useRef)(null),t=Object(a.useState)(0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=function(){switch(s){case-1:return"Your browser does not support Media";case-2:return"The resolution is not supported by your device.";case-3:return"Permissions have not been granted.";case-4:return"An error occurred.";default:return""}}();return Object(a.useEffect)((function(){var e=!0;if(n.current&&0===s){var t=n.current;try{navigator.mediaDevices.getUserMedia(f).then((function(n){if(e){var r=n.getVideoTracks();console.info("Got stream with constraints:",f),console.info("Using video device: "+r[0].label),n.onremovetrack=function(){console.log("Stream ended")},n.onaddtrack=function(){console.log("Stream added")},t.srcObject=n,t.play(),l(1)}})).catch((function(n){if(e)switch(n.name){case"ConstraintNotSatisfiedError":l(-2);break;case"PermissionDeniedError":case"NotAllowedError":l(-3);break;default:l(-4),console.warn("following error occurred: ",n)}}))}catch(r){l(-1)}}return function(){e=!1}}),[]),i.a.createElement("article",null,i.a.createElement("figure",null,i.a.createElement(m,null,s<0&&i.a.createElement(g,{text:d}),s>=0&&i.a.createElement("video",{ref:n,controls:!0},i.a.createElement(g,{text:d}))),i.a.createElement("figcaption",null,"Allowing Permission Will Reflect The Stream of Your Camera")),i.a.createElement("p",null,"These days, the services use cam are everywhere like Zoom and Google Meet.",i.a.createElement("br",null),"Actually I've never gotten a chance to use mediaDevices, and like to use it.",i.a.createElement("br",null),"Seeing this work feels still amazing."),i.a.createElement("p",null,"Following code is used here."),i.a.createElement(c.a,{code:"const videoRef = useRef(null);\nconst [mediaPermission, setMediaPermission] = useState(0);\nuseEffect(() => {\n  // permission is answered by promise and \n  // the component can be destroyed\n  // at the time of receiving the answer\n  // set flag for not destroyed.\n  let on = true;\n  if (videoRef.current && mediaPermission === 0) {\n    // status 0: not tried\n    // status 1: got permission\n    // status < 0: error not denied permission\n    const video = videoRef.current;\n    try {\n      // some browsers do not support mediaDevices\n      // https://developer.mozilla.org/ko/docs/Web/API/MediaDevices \n      navigator.mediaDevices\n        .getUserMedia(constraints)\n        .then(function(stream) {\n          if (!on) {\n            return;\n          }\n          const videoTracks = stream.getVideoTracks();\n          console.info('Got stream with constraints:', constraints);\n          console.info('Using video device: ' + videoTracks[0].label);\n          stream.onremovetrack = function() {\n            console.log('Stream ended');\n          };\n          stream.onaddtrack = function() {\n            console.log('Stream added');\n          };\n          video.srcObject = stream;\n          video.play();\n          setMediaPermission(1);\n        })\n        .catch(function(error) {\n          if (!on) {\n            return;\n          }\n          switch (error.name) {\n            case 'ConstraintNotSatisfiedError':\n              setMediaPermission(-2);\n              break;\n            case 'PermissionDeniedError':\n            case 'NotAllowedError':\n              setMediaPermission(-3);\n              break;\n            default:\n              setMediaPermission(-4);\n              console.warn('following error occurred: ', error);\n          }\n        });\n    } catch (e) {\n      setMediaPermission(-1);\n    }\n  }\n  return () => {\n    on = false;\n  };\n}, []);\n"}))};n.default=v}}]);